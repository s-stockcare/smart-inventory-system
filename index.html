<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>StockCare - Mobile Friendly Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;transition:0.3s;}
body{display:flex;background:#0f172a;color:white;transition:0.3s;}
body.light{background:#f1f5f9;color:#111827;}
body.light .sidebar{background:linear-gradient(180deg,#94a3b8,#cbd5e1);color:#111827;}
body.light .card,body.light .add-product,body.light table,body.light .chart-container{background:rgba(255,255,255,0.8);color:#111827;backdrop-filter:none;}
body.light table th{background:rgba(14,165,233,0.7);color:white;}

/* Sidebar */
.sidebar{width:250px;height:100vh;background:linear-gradient(180deg,#111827,#1e293b);color:white;padding:25px;position:fixed;left:0;top:0;transition:0.3s;}
.sidebar h2{margin-bottom:40px;}
.sidebar ul{list-style:none;}
.sidebar ul li{padding:15px 0;cursor:pointer;transition:0.3s;}
.sidebar ul li:hover{color:#38bdf8;transform:translateX(5px);}

/* Hamburger menu for mobile */
.hamburger{
    display:none;
    position:fixed;
    top:20px;
    left:20px;
    font-size:30px;
    cursor:pointer;
    z-index:999;
}

/* Main */
.main{margin-left:250px;padding:30px;width:100%;transition:0.3s;}

/* Navbar */
.navbar{display:flex;justify-content:space-between;align-items:center;margin-bottom:40px;}
.navbar h1{font-weight:600;}
.toggle-btn{padding:8px 15px;border:none;border-radius:8px;background:linear-gradient(90deg,#0ea5e9,#0284c7);cursor:pointer;color:white;transition:0.3s;}
.toggle-btn:hover{opacity:0.9;}

/* Cards */
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:25px;}
.card{background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);padding:25px;border-radius:15px;box-shadow:0 8px 25px rgba(0,0,0,0.3);transition:0.3s linear;}
.card:hover{transform:translateY(-5px);background:linear-gradient(135deg,#0ea5e9,#3b82f6);}
.card h3{font-size:16px;color:#94a3b8;margin-bottom:10px;}
.card p{font-size:28px;font-weight:600;}

/* Add Product Form */
.add-product{margin-top:40px;background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);padding:25px;border-radius:15px;box-shadow:0 8px 25px rgba(0,0,0,0.3);}
.add-product input{padding:10px;margin:5px;width:calc(100% - 20px);border:none;border-radius:8px;}
.add-product button{padding:10px 20px;background:linear-gradient(90deg,#0ea5e9,#0284c7);color:white;border:none;border-radius:8px;cursor:pointer;transition:0.3s;width:100%;}
.add-product button:hover{opacity:0.9;}

/* Table */
table{width:100%;margin-top:40px;border-collapse:collapse;background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);border-radius:15px;overflow:hidden;box-shadow:0 8px 25px rgba(0,0,0,0.3);}
table th, table td{padding:15px;text-align:left;}
table th{background:rgba(14,165,233,0.7);color:white;}
table tr:nth-child(even){background:rgba(255,255,255,0.05);}
.status-good{color:#22c55e;font-weight:600;}
.status-warning{color:#facc15;font-weight:600;}
.status-danger{color:#ef4444;font-weight:600;}

/* Chart container */
.chart-container{margin-top:40px;background:rgba(255,255,255,0.1);backdrop-filter:blur(10px);padding:25px;border-radius:15px;box-shadow:0 8px 25px rgba(0,0,0,0.3);}

/* Responsive */
@media screen and (max-width:768px){
    .sidebar{left:-260px;}
    .main{margin-left:0;padding:20px;}
    .hamburger{display:block;}
}
</style>
</head>
<body>

<div class="hamburger" onclick="toggleSidebar()">‚ò∞</div>

<div class="sidebar">
    <h2>üì¶ StockCare</h2>
    <ul>
        <li>üè† Dashboard</li>
        <li>üì¶ Products</li>
        <li>‚ûï Add Product</li>
        <li>‚è∞ Expiry Alerts</li>
        <li>üìä Reports</li>
        <li>‚öô Settings</li>
    </ul>
</div>

<div class="main">
    <div class="navbar">
        <h1>Premium Dashboard</h1>
        <div>
            üë§ Admin
            <button class="toggle-btn" onclick="toggleTheme()">Toggle Dark/Light</button>
        </div>
    </div>

    <div class="cards">
        <div class="card"><h3>Total Products</h3><p>0</p></div>
        <div class="card"><h3>Expiring Soon</h3><p>0</p></div>
        <div class="card"><h3>Low Stock</h3><p>0</p></div>
        <div class="card"><h3>Out of Stock</h3><p>0</p></div>
    </div>

    <div class="add-product">
        <h2>Add New Product</h2>
        <input type="text" id="name" placeholder="Product Name">
        <input type="number" id="quantity" placeholder="Quantity">
        <input type="date" id="expiry">
        <button onclick="addProduct()">Add Product</button>
    </div>

    <table></table>

    <div class="chart-container">
        <canvas id="stockChart" height="150"></canvas>
        <canvas id="statusChart" height="150" style="margin-top:30px;"></canvas>
    </div>
</div>

<script>
const API_URL = "https://your-render-url.onrender.com"; // Replace with your backend URL
let products = [];

function toggleTheme(){document.body.classList.toggle("light");}

function toggleSidebar(){
    const sidebar = document.querySelector(".sidebar");
    sidebar.style.left = (sidebar.style.left === "0px") ? "-260px" : "0px";
}

async function fetchProducts(){
    const res = await fetch(`${API_URL}/products`);
    products = await res.json();
    renderDashboard();
}

async function addProduct(){
    let name=document.getElementById("name").value;
    let quantity=parseInt(document.getElementById("quantity").value);
    let expiry=document.getElementById("expiry").value;
    if(!name||!quantity||!expiry){alert("Fill all fields");return;}
    await fetch(`${API_URL}/products`,{
        method:"POST",
        headers:{"Content-Type":"application/json"},
        body:JSON.stringify({name,quantity,expiry})
    });
    document.getElementById("name").value="";
    document.getElementById("quantity").value="";
    document.getElementById("expiry").value="";
    fetchProducts();
}

function renderDashboard(){
    let table=document.querySelector("table");
    table.innerHTML=`<tr><th>Product</th><th>Quantity</th><th>Expiry Date</th><th>Status</th></tr>`;
    let today=new Date(),expiringSoon=0,lowStock=0,outStock=0;
    let chartLabels=[],chartData=[],statusCounts={Good:0,Low:0,Out:0};

    products.forEach(p=>{
        let expiryDate=new Date(p.expiry);
        let diffDays=(expiryDate-today)/(1000*60*60*24);
        let status="Good",className="status-good";

        if(p.quantity==0){status="Out of Stock";className="status-danger";outStock++;statusCounts.Out++;}
        else if(p.quantity<=5){statusCounts.Low++;lowStock++;}
        if(diffDays<=7){status="Expiring Soon";className="status-warning";expiringSoon++;statusCounts.Low++;}
        if(status==="Good"){statusCounts.Good++;}

        table.innerHTML+=`<tr><td>${p.name}</td><td>${p.quantity}</td><td>${p.expiry}</td><td class="${className}">${status}</td></tr>`;
        chartLabels.push(p.name); chartData.push(p.quantity);

        if(diffDays>=0 && diffDays<=3){alert(`‚ö†Ô∏è Product "${p.name}" is expiring in ${Math.ceil(diffDays)} day(s)`);}
    });

    document.querySelectorAll(".card p")[0].innerText=products.length;
    document.querySelectorAll(".card p")[1].innerText=expiringSoon;
    document.querySelectorAll(".card p")[2].innerText=lowStock;
    document.querySelectorAll(".card p")[3].innerText=outStock;

    renderStockChart(chartLabels,chartData);
    renderStatusChart(statusCounts);
}

let stockChart,statusChart;
function renderStockChart(labels,data){
    const ctx=document.getElementById('stockChart').getContext('2d');
    if(stockChart) stockChart.destroy();
    stockChart=new Chart(ctx,{
        type:'bar',
        data:{labels:labels,datasets:[{label:'Quantity',data:data,backgroundColor:'rgba(14,165,233,0.7)'}]},
        options:{responsive:true,plugins:{legend:{display:false}},scales:{y:{beginAtZero:true}}}
    });
}
function renderStatusChart(statusCounts){
    const ctx=document.getElementById('statusChart').getContext('2d');
    if(statusChart) statusChart.destroy();
    statusChart=new Chart(ctx,{
        type:'pie',
        data:{labels:['Good','Low/Expiring','Out of Stock'],datasets:[{data:[statusCounts.Good,statusCounts.Low,statusCounts.Out],backgroundColor:['#22c55e','#facc15','#ef4444']}]},
        options:{responsive:true,plugins:{legend:{position:'bottom'}}}
    });
}

fetchProducts();
</script>

</body>
</html>
